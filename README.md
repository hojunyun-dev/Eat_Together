# ğŸ›µ ê°™ì´ë¨¹ì í”„ë¡œì íŠ¸ ğŸ›µ

- í˜¼ì ë°°ë‹¬ ìŒì‹ì„ ì‹œì¼œ ë¨¹ë‹¤ ë³´ë©´ ë©”ë‰´ ì„ íƒë„ ì–´ë µê³  ë°°ë‹¬ë¹„ë„ ë¶€ë‹´ë˜ê¸° ì‰½ìŠµë‹ˆë‹¤.
  ê°™ì´ë¨¹ìëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´, **ë°°ë‹¬ì„ â€˜í•¨ê»˜â€™ë¡œ ë°”ê¾¸ëŠ” í”Œë«í¼**ì…ë‹ˆë‹¤.

  <p align="center">
  <img src="img/Banner.png" alt="Banner" width="500"/>
  </p>
  <p align="center">
  <img src="img/Logo.png" alt="Banner" width="400"/>
  </p>

## ğŸ“Œ ì£¼ìš” ê¸°ëŠ¥

- ë©”ë‰´ë¥¼ ê³µìœ  ì¥ë°”êµ¬ë‹ˆì— ë‹´ì•„ í•¨ê»˜ ì£¼ë¬¸
- ì‹¤ì‹œê°„ ì±„íŒ…ìœ¼ë¡œ ì£¼ë³€ ì‚¬ëŒê³¼ ë©”ë‰´ì™€ ë°°ë‹¬ ì¡°ìœ¨

## ğŸ’¡ í•µì‹¬ ê°€ì¹˜ ë° ì°¨ë³„ì 

- í˜¼ìì„œ ë°°ë‹¬ ì‹œ ë°œìƒí•˜ëŠ” ë¶€ë‹´ ìµœì†Œí™”
- ì‹¤ì‹œê°„ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ìœ¼ë¡œ í•¨ê»˜ ì£¼ë¬¸ íš¨ìœ¨ ê·¹ëŒ€í™”
- ë°°ë‹¬ì„ í˜¼ìê°€ ì•„ë‹Œ ì—¬ëŸ¿ì´ì„œ ë” í¸ë¦¬í•˜ê³  ì¦ê²ê²Œ ì¦ê¸¸ ìˆ˜ ìˆë„ë¡ ì„¤ê³„

## ğŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

<details>
<summary>í´ë¦­í•˜ì—¬ í”„ë¡œì íŠ¸ íŒŒì¼ êµ¬ì¡°ë¥¼ í™•ì¸í•˜ì„¸ìš”.</summary>

ğŸ“¦ project-root/   
â”£ ğŸ“‚ data/   
â”£ ğŸ“‚ gradle/  
â”£ ğŸ“‚ grafana/  
â”£ ğŸ“‚ grafana_data/  
â”£ ğŸ“‚ logs/  
â”£ ğŸ“‚ mysql_exporter/  
â”£ ğŸ“‚ prometheus/  
â”£ ğŸ“‚ src/  
â”ƒ â”£ ğŸ“‚ main/  
â”ƒ â”ƒ â”£ ğŸ“‚ java/  
â”ƒ â”ƒ â”ƒ â”— ğŸ“‚ com/  
â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚ example/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚ eat_together/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ domain/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ cart/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ controller/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ dto/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ entity/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ repository/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚ service/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ chat/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ menu/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ notification/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ order/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ payment/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ rider/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ social/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚ store/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚ users/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ global/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ common/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ config/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ dto/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ entity/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ exception/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ redis/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ util/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚ websocket/  
â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œ EatTogetherApplication.java  
â”ƒ â”ƒ â”— ğŸ“‚ resources/  
â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ static/  
â”ƒ â”ƒ â”ƒ â”— ğŸ“œ application.yml  
â”ƒ â”£ ğŸ“‚ test/  
â”ƒ â”— ğŸ“œ .env  
â”£ ğŸ“œ .gitattributes  
â”£ ğŸ“œ .gitignore  
â”£ ğŸ“œ build.gradle  
â”£ ğŸ“œ docker-compose.yml  
â”£ ğŸ“œ Dockerfile  
â”£ ğŸ“œ Dockerfile.elasticsearch  
â”£ ğŸ“œ gradlew  
â”£ ğŸ“œ gradlew.bat  
â”£ ğŸ“œ README.md  
â”£ ğŸ“œ settings.gradle  
â”— ğŸ“‚ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬

</details> 

## ğŸ’» ê¸°ìˆ  ìŠ¤íƒ

<div align="center">

### **Backend**

<img src="https://img.shields.io/badge/java-%23ED8B00.svg?style=for-the-badge&logo=java&logoColor=white">
<img src="https://img.shields.io/badge/spring%20Boot-%236DB33F.svg?style=for-the-badge&logo=spring&logoColor=white">
<img src="https://img.shields.io/badge/Spring%20Security-6DB33F?style=for-the-badge&logo=springsecurity&logoColor=white">
<img src="https://img.shields.io/badge/JPA-59666C?style=for-the-badge&logo=hibernate&logoColor=white">
<img src="https://img.shields.io/badge/QueryDSL-6DB33F?style=for-the-badge&logo=&logoColor=white">
<img src="https://img.shields.io/badge/JWT-00B9F1?style=for-the-badge&logo=&logoColor=white">
<img src="https://img.shields.io/badge/WebSocket-009000?style=for-the-badge&logo=&logoColor=white">
<img src="https://img.shields.io/badge/Kafka-231F20?style=for-the-badge&logo=apachekafka&logoColor=white">

### **Database & Cache**

<img src="https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=mysql&logoColor=white"> 
<img src="https://img.shields.io/badge/Redis-FF4438?style=for-the-badge&logo=redis&logoColor=white">

### **Infra & CI/CD**

![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)
![githubactions](https://img.shields.io/badge/github%20actions-2088FF?style=for-the-badge&logo=githubactions&logoColor=white)
![AWS EC2](https://img.shields.io/badge/AWS%20EC2-FF9900?style=for-the-badge&logo=amazon-ec2&logoColor=white)

### **Observability**

![Prometheus](https://img.shields.io/badge/Prometheus-E6522C?style=for-the-badge&logo=prometheus&logoColor=white)
![Grafana](https://img.shields.io/badge/Grafana-F46800.svg?style=for-the-badge&logo=grafana&logoColor=white)
![Kibana](https://img.shields.io/badge/kibana-005571.svg?style=for-the-badge&logo=kibana&logoColor=white)
![Elasticsearch](https://img.shields.io/badge/Elasticsearch-005571.svg?style=for-the-badge&logo=elasticsearch&logoColor=white)
![Filebeat](https://img.shields.io/badge/Filebeat-005571.svg?style=for-the-badge&logo=beats&logoColor=white)

### **Test Tools**

![Postmanr](https://img.shields.io/badge/Postman-FF6C37.svg?style=for-the-badge&logo=postman&logoColor=white)
![Apache Jmeter](https://img.shields.io/badge/jmeter-D22128.svg?style=for-the-badge&logo=apachejmeter&logoColor=white)
![Locust](https://img.shields.io/badge/Locust-009000.svg?style=for-the-badge&logo=&logoColor=white)

### **Collaboration**

![Slack](https://img.shields.io/badge/Slack-4A154B?style=for-the-badge&logo=slack&logoColor=white)
![Git](https://img.shields.io/badge/git-%23F05033.svg?style=for-the-badge&logo=git&logoColor=white)
![GitHub](https://img.shields.io/badge/github-%23121011.svg?style=for-the-badge&logo=github&logoColor=white)
![Notion](https://img.shields.io/badge/Notion-%23000000.svg?style=for-the-badge&logo=notion&logoColor=white)
![draw.io](https://img.shields.io/badge/draw.io-F08705.svg?style=for-the-badge&logo=diagramsdotnet&logoColor=white)
![Google Docs](https://img.shields.io/badge/google%20docs-4285F4.svg?style=for-the-badge&logo=googledocs&logoColor=white)

</div>

## ğŸ“ Architecture

![Architecture.png](img%2FArchitecture.png)

## ğŸ’¬ ERD

![ERD.png](img%2FERD.png)

---

## ğŸ› ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### â³ Redis ìºì‹± ì ìš© ì‹œ LocalDateTime ì§ë ¬í™” ì˜¤ë¥˜ ###

- **ë¬¸ì œ ìƒí™©**: ìºì‹±ëœ `MenuResponseDto` / `PagingMenuResponseDto` ê°ì²´ ì§ë ¬í™” ì‹œ
  `SerializationException: Java 8 date/time type LocalDateTime not supported by default` ë°œìƒ


- **ì›ì¸ ë¶„ì„**: Jackson ê¸°ë³¸ ì§ë ¬í™”ì—ì„œëŠ” `LocalDateTime` íƒ€ì…ì„ ì²˜ë¦¬í•˜ì§€ ëª»í•´ ë°œìƒ

    - ì‹œë„í•œ ë°©ë²•

        ```java
        ObjectMapper objectMapper = new ObjectMapper()
            .registerModule(new JavaTimeModule())   // LocalDateTime ì§€ì›
            .disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);
        ```

      â†’ ì§ë ¬í™”ëŠ” í•´ê²°ëì§€ë§Œ, ìºì‹±ëœ DTO ì—­ì§ë ¬í™” ê³¼ì •ì—ì„œ ë§¤í•‘ ì˜¤ë¥˜ ë°œìƒ


- **í•´ê²°**: DTO ì „ìš© RedisTemplateì„ ìƒì„±í•˜ì—¬ Jackson2JsonRedisSerializer + JavaTimeModule ì„¤ì • ì ìš©

    ```java

    @Bean
    public RedisTemplate<String, PagingMenuResponseDto> pagingMenuRedisTemplate(
            RedisConnectionFactory connectionFactory) {
        RedisTemplate<String, PagingMenuResponseDto> template = new RedisTemplate<>();
        template.setConnectionFactory(connectionFactory);
        template.setKeySerializer(new StringRedisSerializer());

        Jackson2JsonRedisSerializer<PagingMenuResponseDto> serializer =
                new Jackson2JsonRedisSerializer<>(PagingMenuResponseDto.class);
        serializer.setObjectMapper(objectMapper());

        template.setValueSerializer(serializer);
        return template;
    }

    ```
  â†’ ì´ ë°©ì‹ìœ¼ë¡œ LocalDateTime í•„ë“œë¥¼ í¬í•¨í•œ DTOë„ ë¬¸ì œì—†ì´ ìºì‹±/ì¡°íšŒ ê°€ëŠ¥

---

### ğŸ—ï¸ Redis ìºì‹œ í‚¤ ì¶©ëŒë¡œ ì¸í•œ ë©”ë‰´ ì¡°íšŒ ë¬¸ì œ ###

- **ë¬¸ì œìƒí™©**: ë©”ë‰´ ë‹¨ê±´ ì¡°íšŒ ì‹œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë§¤ì¥ì—ì„œ Redisì— ì €ì¥ëœ ë©”ë‰´ê°€ ì¡°íšŒ ì„±ê³µìœ¼ë¡œ ì‘ë‹µë˜ëŠ” ë¬¸ì œê°€ ë°œìƒ
    1. Redisì— `menuId=3`ì´ ì´ë¯¸ ìºì‹±ë˜ì–´ ìˆìŒ

       <img src="img/RedisCacheTroubleshooting_1.png" width="300"/>

    2. ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë§¤ì¥ `storeId=333`ì—ì„œ `menuId=3` ì¡°íšŒ ì‹œë„

       <img src="img/RedisCacheTroubleshooting_2.png" width="400"/>

    3. ì¡°íšŒê°€ ì„±ê³µí•´ë²„ë¦¼(ì˜¤ë™ì‘)

       <img src="img/RedisCacheTroubleshooting_3.png" width="400"/>


- **ì›ì¸ ë¶„ì„**:
    - **ìºì‹œ í‚¤ê°€ `menuId` ë‹¨ì¼ ê°’**ë§Œ í¬í•¨í•˜ë„ë¡ ì„¤ê³„ë¨
    - ì„œë¡œ ë‹¤ë¥¸ ë§¤ì¥ì´ë¼ë„ `menuId`ê°€ ê°™ìœ¼ë©´ **ê°™ì€ ìºì‹œ ì—”íŠ¸ë¦¬**ë¥¼ ì°¸ì¡° â†’ ë§¤ì¥ ê²€ì¦ ì‹¤íŒ¨


- **í•´ê²°**:
    - ìºì‹œ í‚¤ êµ¬ì¡° ë³€ê²½
        - ê¸°ì¡´: `menu:{menuId}`
        - ë³€ê²½: `menu:{storeId}:{menuId}`

          <img src="img/RedisCacheTroubleshooting_4.png" width="400"/>


- **ê²°ê³¼**:
    - ìºì‹œ í‚¤ì— `storeId`ë¥¼ í¬í•¨ì‹œì¼œ **ë§¤ì¥ ë‹¨ìœ„ ê²€ì¦**ì´ ê°€ëŠ¥í•´ì§
    - ì˜ëª»ëœ ë§¤ì¥ì—ì„œ ê°™ì€ `menuId` ìš”ì²­ ì‹œ **ìºì‹œ ì¬ì‚¬ìš©ì´ ì°¨ë‹¨**ë˜ì–´, ë°ì´í„° ì •í•©ì„± í™•ë³´

---

### ğŸ” ì£¼ë¬¸ ë‚´ì—­ ì¡°íšŒ ì‹œ N+1 ë¬¸ì œ ë°œìƒ ###

- **ë¬¸ì œ ìƒí™©**:
    - ì£¼ë¬¸ í˜ì´ì§• ì¡°íšŒ ì‹œ ì£¼ë¬¸ ìˆ˜ ë§Œí¼ ì¶”ê°€ ì¿¼ë¦¬ ë°œìƒ (N+1 ë¬¸ì œ)
    - ì£¼ë¬¸ ë‹¨ì¼ ì¡°íšŒ ì‹œ ì£¼ë¬¸ ì•„ì´í…œ ìˆ˜ ë§Œí¼ ì¶”ê°€ ì¿¼ë¦¬ ë°œìƒ (N+1 ë¬¸ì œ)


- **ì›ì¸ ë¶„ì„**:
    - í˜ì´ì§• ì¡°íšŒ: store ì •ë³´ë¥¼ ì£¼ë¬¸ë§ˆë‹¤ ë³„ë„ ì¡°íšŒ
    - ë‹¨ì¼ ì¡°íšŒ: orderItemsì™€ menuë¥¼ fetch joiní•˜ì§€ ì•Šì•„ ë³„ë„ ì¿¼ë¦¬ ë°œìƒ


- **í•´ê²°**:
    - í˜ì´ì§• ì¡°íšŒ
        - QueryDSLì— .join(order.store).fetchJoin() ì¶”ê°€ â†’ ì£¼ë¬¸ê³¼ ê°€ê²Œ ì •ë³´ë¥¼ í•œ ë²ˆì— ì¡°íšŒ
    - ë‹¨ì¼ ì¡°íšŒ
        - QueryDSLì— ì•„ë˜ ë‚´ìš©ì„ ì¶”ê°€:
          ```java
          .join(order.store).fetchJoin() // ì£¼ë¬¸ê³¼ ê°€ê²Œ ì •ë³´ë¥¼ í•œ ë²ˆì— ì¡°íšŒ
          .leftJoin(order.orderItems, orderItem).fetchJoin() // ì£¼ë¬¸ê³¼ ì£¼ë¬¸ì•„ì´í…œì„ í•œ ë²ˆì— ì¡°íšŒ
          .leftJoin(orderItem.menu).fetchJoin() // ì£¼ë¬¸ì•„ì´í…œê³¼ ë©”ë‰´ë¥¼ í•œ ë²ˆì— ì¡°íšŒ
          ```         

---

### ğŸ³ Grafana & Prometheus / Docker-compose ì—°ë™ ì˜¤ë¥˜ ###

- **ë¬¸ì œ ìƒí™©**:
    - Docker Composeì—ì„œ `prom/mysqld-exporter`ë¥¼ í™˜ê²½ë³€ìˆ˜ `DATA_SOURCE_NAME` ë°©ì‹ìœ¼ë¡œ ì„¤ì •í–ˆìœ¼ë‚˜, **Prometheusì—ì„œ íƒ€ê²Ÿì´ ì¸ì‹ë˜ì§€ ì•ŠìŒ(ìˆ˜ì§‘ ì‹¤íŒ¨)**
    ```
  mysqld_exporter:
    image: prom/mysqld-exporter
    # ...
    environment:
      # mysql ì„œë¹„ìŠ¤ ì´ë¦„ê³¼ MySQL ê¸°ë³¸ í¬íŠ¸ 3306 ì‚¬ìš©
      - DATA_SOURCE_NAME=exporter:YOUR_PASSWORD@(mysql:3306)/   # â† ë¬¸ì œ ë°œìƒ
    depends_on:
      - mysql
  ```

- **ì›ì¸ ë¶„ì„**:
    - **í•µì‹¬ ì›ì¸**: ì»¨í…Œì´ë„ˆì—ì„œ `DATA_SOURCE_NAME` ê°’ì´ **ì •ìƒì ìœ¼ë¡œ ì£¼ì…ë˜ì§€ ì•Šì•„**, Exporterê°€ MySQL ì ‘ì† ì •ë³´ë¥¼ ì¸ì‹í•˜ì§€ ëª»í•¨
    - ê·¸ ê²°ê³¼, `Exporter`ê°€ ë©”íŠ¸ë¦­ì„ ë…¸ì¶œí•˜ì§€ ëª»í•´ **Prometheusê°€ íƒ€ê²Ÿì„ ì¡ì§€ ëª»í•¨**


- **í•´ê²°**:
    - **í™˜ê²½ë³€ìˆ˜ ì£¼ì…ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ **, ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œ **ëª…ë ¹ì¤„ ì¸ì(í”Œë˜ê·¸)ë¡œ ì§ì ‘ ê°’ ì£¼ì…**í•˜ë„ë¡ ë³€ê²½
  ```yaml
    mysqld_exporter:
      image: prom/mysqld-exporter
      container_name: mysqld_exporter
      ports:
        - "9104:9104"
      depends_on:
        - mysql
      command:
        - "--mysqld.username=${MYSQL_USERNAME}:${MYSQL_PASSWORD}"
        - "--mysqld.address=mysql:${MYSQL_PORT}"
      networks:
        - monitoring
    ```
- **ê²°ê³¼**:
    - **Prometheus**: Targets í˜ì´ì§€ì—ì„œ `mysqld_exporter` ìƒíƒœê°€ **UP**ìœ¼ë¡œ í‘œì‹œ
    - **Exporter ì—”ë“œí¬ì¸íŠ¸**: ë¸Œë¼ìš°ì €/CLIë¡œ `http://localhost:9104/metrics` ì ‘ì† ì‹œ ë©”íŠ¸ë¦­ ì‘ë‹µ í™•ì¸
    - **ì»¨í…Œì´ë„ˆ ìƒíƒœ/ë¡œê·¸**: `docker compose ps mysqld_exporter`, `docker compose logs -f mysqld_exporter`ì—ì„œ ì •ìƒ ê¸°ë™ í™•ì¸

---

### ğŸ” ì›¹ì†Œì¼“ ì—°ê²° í›„ ì¸ì¦ ###

- **ë¬¸ì œ ìƒí™©**:
    - ê¸°ì¡´ì˜ ì¸ì¦ ê³¼ì •ì€ `jwtFilter`ë¥¼ í†µí•´ ì§„í–‰ëë‹¤.
    - ê·¸ëŸ¬ë‚˜ ì›¹ì†Œì¼“ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•œ í›„ë¶€í„°ëŠ” ì¸ì¦ ê³¼ì •ì´ ê±°ì³ì§€ì§€ ì•Šì•˜ë‹¤.


- **ì›ì¸ ë¶„ì„**:
    - `JwtFilter`ê°€ ìƒì†ë°›ì€ `OncePerRequestFilter`ëŠ” **Http ìš”ì²­ì—ì„œë§Œ ì‘ë™**í•˜ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ í”„ë¡œí† ì½œì¸ **ì›¹ì†Œì¼“ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ í•˜ë©´ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤.**
    - ë”°ë¼ì„œ `JwtFilter`ë¥¼ í†µí•œ ì¸ì¦ê³¼ì •ì„ ê±°ì¹  ìˆ˜ ì—†ë‹¤.


- **í•´ê²°**:
    - `Command(Connect, Subscribe, Send, Disconnect)`ë¥¼ í¬í•¨í•œ **STOMP í”„ë ˆì„**ì„ í´ë¼ì´ì–¸íŠ¸ê°€ ì „ì†¡í•˜ë©´ ì¤‘ê°„ì—ì„œ `ChannelInterceptor`ê°€ ê°€ë¡œì±ˆë‹¤.
    - ìš©ë„ì— ë§ê²Œ ê° ëª…ë ¹ì–´ ë³„ë¡œ ì¸ì¦ ê³¼ì •ì„ ì‘ì„±í•˜ë©´ ê·¸ ì½”ë“œì— ë”°ë¼ ê²€ì‚¬í•œ í›„ **ì¸ì¦ë˜ì—ˆì„ ê²½ìš° ë©”ì„¸ì§€ë¥¼ ì „ì†¡**í•  ìˆ˜ ìˆê²Œ ëœë‹¤.


- **ê²°ê³¼**:
    - í…ŒìŠ¤íŠ¸ ì‹œ í† í°ì„ í¬í•¨í•˜ì§€ ì•Šìœ¼ë©´ **CONNECT ìì²´ê°€ ë¶ˆê°€ëŠ¥**í–ˆë‹¤. ë˜í•œ **í† í°ì´ ë§Œë£Œëœ ê²½ìš°**ì—ë„ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤. ë¡œê·¸ì¸ì„ í†µí•´ í† í°ì„ ë°œê¸‰ë°›ê³  **ìœ íš¨í•œ í† í°ì„ í¬í•¨**í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ í–ˆì„
      ë•Œ ì •ìƒì ìœ¼ë¡œ
      `CONNECT`ê°€ ë˜ì—ˆê³  **ì±„íŒ… ê¸°ëŠ¥ë„ ì •ìƒì ìœ¼ë¡œ ì‘ë™**í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.

---

### ğŸ”€ ë‹¤ë¥¸ ë§¤ì¥ ë©”ë‰´ ì„ì„ & ì¤‘ë³µ ì•„ì´í…œ ë³‘í•© ì‹¤íŒ¨ ###

- **ë¬¸ì œ ìƒí™©**:
    - ì¥ë°”êµ¬ë‹ˆì— ì„œë¡œ ë‹¤ë¥¸ ë§¤ì¥ ë©”ë‰´ê°€ ì„ì—¬ **ë°°ë‹¬íŒ/ìµœì†Œì£¼ë¬¸ê¸ˆì•¡ ê³„ì‚°**ì´ ê¹¨ì§
    - ë™ì¼ ë©”ë‰´ê°€ ì¤‘ë³µí–‰ìœ¼ë¡œ ìŒ“ì—¬ ì´ì•¡ì´ ë¹„ì •ìƒ


- **ì›ì¸ ë¶„ì„**:
    - `storeId` ì œì•½ ë¯¸í¡ â†’ **ì¶”ê°€/ìˆ˜ì • ì‹œ ê²€ì¦ ëˆ„ë½**
    - `(cart_id, menu_id)` **UNIQUE ì œì•½ ë¶€ì¬**ë¡œ `upsert` ì‹¤íŒ¨


- **í•´ê²°**:
    - **ë‹¨ì¼ ë§¤ì¥ ê·œì¹™**: ì²« ì•„ì´í…œì˜ `storeId` ê³ ì •, ë‹¤ë¥¸ ë§¤ì¥ ì¶”ê°€ ì‹œ êµì²´/ì¶”ê°€ì·¨ì†Œ ì •ì±…
    - **ì¤‘ë³µ ë³‘í•©(upsert)**: ì„œë¹„ìŠ¤ ë ˆë²¨ `find â†’ ifPresent(quantity++) else insert`
    - **ìŠ¤í‚¤ë§ˆ ì œì•½**: `(cart_id, menu_id) UNIQUE`ë¡œ ë°ì´í„° ì¼ê´€ì„± ë³´ì¥


- **ê²°ê³¼**:
    - ê²°ì œ ë‹¨ê³„ ì˜¤ë¥˜ ì œê±°, CS ê°ì†Œ
    - ë°ì´í„° ì •í•©ì„±/ê°€ë…ì„± í–¥ìƒ, ìœ ì§€ë³´ìˆ˜ ìš©ì´

---

## ğŸš€ ì„±ëŠ¥ ê°œì„ 

### ğŸª ë§¤ì¥ ê²€ìƒ‰ ê¸°ëŠ¥ ì„±ëŠ¥ ê°œì„  ###

- **ê¸°ëŠ¥**:
    - ê¸°ì¡´ ë§¤ì¥ ê²€ìƒ‰ ê¸°ëŠ¥ì˜ ê²½ìš° Like ì¿¼ë¦¬ë¥¼ ì´ìš©í•œ ë°©ì‹ìœ¼ë¡œ ê²€ìƒ‰ ê¸°ëŠ¥ì´ ì‘ë™


- **ë¬¸ì œ ì •ì˜**:
    - **Like ì¿¼ë¦¬ë¥¼ ì´ìš©í•œ ë°©ì‹**ìœ¼ë¡œ ê²€ìƒ‰ ê¸°ëŠ¥ì´ ì‘ë™í•˜ë‹¤ë³´ë‹ˆ `Full Scan Table` ë¬¸ì œê°€ ë°œìƒí•˜ì—¬, ë§¤ì¥ ìˆ˜ê°€ ì¦ê°€í•¨ì—ë”°ë¼ ì„±ëŠ¥ì´ ì €í•˜ë  ìš°ë ¤


- **í•´ê²°**:
    - `Full Text Index` vs `Elasticsearch` ë„ì… ê²€í† 
    - `Full Text Index`ë¡œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì§„í–‰ ì¤‘, **ë¶€ë¶„ ê²€ìƒ‰ ë¯¸ì§€ì›** ë¬¸ì œ ë°œê²¬
    - ìµœì¢…ì ìœ¼ë¡œ **Elasticsearch ë„ì…**


- **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
    - **í…ŒìŠ¤íŠ¸ ë„êµ¬**: `Locust`
    - **ì‹œë‚˜ë¦¬ì˜¤**
        - ì„ì˜ ë§¤ì¥ **30,000ê°œ ìƒì„±** (`ë§›ì§‘_1 ~ ë§›ì§‘_9999 * 3`)
        - **ìµœëŒ€ ë™ì‹œ ì ‘ì† ì‚¬ìš©ì 1,000ëª…**
        - ì´ˆë‹¹ **100ëª…ì”© ì¦ê°€**
        - ê²€ìƒ‰ ìœ ì—°ì„± ê²€ì¦ì„ ìœ„í•´ `'ë§›'`, `'ì§‘'` í‚¤ì›Œë“œë¡œë„ ìš”ì²­

#### ğŸ“‰ ë„ì… ì „ (LIKE ì¿¼ë¦¬ ê¸°ë°˜)

<details>
  <summary>ìƒì„¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼</summary>
<img src="img/StoreSearch_1.png" width="600"/>
</details>

| URL (ê²€ìƒ‰ í‚¤ì›Œë“œ)                        | # Requests | # Fails | Median (ms) | 95%ile (ms) | 99%ile (ms) | Avg (ms) | Min | Max   | Avg Size (B) | RPS   | Failures/s |
          |-------------------------------------|------------|---------|-------------|-------------|-------------|----------|-----|-------|--------------|-------|------------|
| `/stores/search?keyword=ë§›`          | 25,350     | 0       | 2600        | 4300        | 5900        | 2655.31  | 34  | 17029 | 3514.89      | 60.3  | 0          |
| `/stores/search?keyword=ë§›ì§‘`         | 25,249     | 0       | 2600        | 4300        | 5900        | 2664.77  | 34  | 14819 | 3514.89      | 60.3  | 0          |
| `/stores/search?keyword=ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë§¤ì¥` | 25,292     | 25,292  | 2600        | 4300        | 5900        | 2636.52  | 21  | 11473 | 97.89        | 64.5  | 64.5       |
| `/stores/search?keyword=ì§‘`          | 25,341     | 0       | 2600        | 4300        | 5800        | 2643.49  | 31  | 12314 | 3514.89      | 57.8  | 0          |
| **Aggregated**                      | 101,232    | 25,292  | 2600        | 4300        | 5900        | 2650.02  | 21  | 17029 | 2661.18      | 242.9 | 64.5       |

#### ğŸš€ ë„ì… í›„ (Elasticsearch ê¸°ë°˜)

<details>
  <summary>ìƒì„¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼</summary>
<img src="img/StoreSearch_2.png" width="600"/>
</details>

| URL (ê²€ìƒ‰ í‚¤ì›Œë“œ)                        | # Requests | # Fails | Median (ms) | 95%ile (ms) | 99%ile (ms) | Avg (ms) | Min | Max | Avg Size (B) | RPS   | Failures/s |
  |-------------------------------------|------------|---------|-------------|-------------|-------------|----------|-----|-----|--------------|-------|------------|
| `/stores/search?keyword=ë§›`          | 25,476     | 0       | 7           | 14          | 72          | 10.04    | 4   | 697 | 3407.89      | 166.6 | 0          |
| `/stores/search?keyword=ë§›ì§‘`         | 25,249     | 0       | 7           | 13          | 68          | 9.76     | 4   | 690 | 3407.89      | 166.7 | 0          |
| `/stores/search?keyword=ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë§¤ì¥` | 25,193     | 25,193  | 7           | 13          | 59          | 9.10     | 4   | 691 | 97.89        | 166.9 | 166.9      |
| `/stores/search?keyword=ì§‘`          | 25,445     | 0       | 7           | 14          | 64          | 9.72     | 4   | 692 | 3407.89      | 162.1 | 0          |
| **Aggregated**                      | 101,363    | 25,193  | 7           | 14          | 66          | 9.66     | 4   | 697 | 2585.21      | 662.3 | 166.9      |

#### ğŸ“ˆ ì„±ëŠ¥ ê°œì„  ìš”ì•½ ë¹„êµ

| í•­ëª©         | ë„ì… ì „       | ë„ì… í›„    | ê°œì„  í­                |
  |------------|------------|---------|---------------------|
| í‰ê·  ì‘ë‹µ ì‹œê°„   | 2650.02 ms | 9.66 ms | ì•½ 274ë°° ê°œì„  (-99.64%) |
| ì •ìƒ í‚¤ì›Œë“œ ì‹¤íŒ¨ìœ¨ | 0%         | 0%      | ìœ ì§€                  |
| ì „ì²´ RPS     | 242.9      | 662.3   | ì•½ 2.7ë°° ì¦ê°€           |

- **ì„±ëŠ¥ ê°œì„  ìš”ì•½**
    - í‰ê·  ì‘ë‹µ ì‹œê°„: **ì•½ 2600ms â†’ 10ms ìˆ˜ì¤€ìœ¼ë¡œ ë‹¨ì¶• (260ë°° ì´ìƒ ê°œì„ )**
    - ì´ˆë‹¹ ì²˜ë¦¬ëŸ‰(RPS): **ì•½ 240 â†’ 660 ì´ìƒ ì¦ê°€ (2.7ë°° í–¥ìƒ)**
    - ê²€ìƒ‰ ê¸°ëŠ¥: **ë¶€ë¶„ ê²€ìƒ‰ ì§€ì›** (`'ì§‘'` ë“± í‚¤ì›Œë“œ ì¼ë¶€ë¡œë„ ê²°ê³¼ ë°˜í™˜ ê°€ëŠ¥)

---

### ğŸ’¬ ì‹¤ì‹œê°„ ì±„íŒ… íë¦„ ###

- **ê¸°ëŠ¥**:
    1. ì›¹ì†Œì¼“ ì—°ê²° ë° ì±„íŒ…ë°© ì…ì¥
    2. ì›¹ì†Œì¼“ ì„¸ì…˜ ì €ì¥
        - `Map<roomId, Set<WebSocketSession>>`
        - keyê°€ ì…ì¥í•œ ì±„íŒ…ë°©ì˜ idì¸ valueê°’ Setì˜ ìš”ì†Œì— ì„¸ì…˜ ì €ì¥
    3. ë©”ì„¸ì§€ ì „ì†¡
        - ë©”ì„¸ì§€ ë°œìƒ ì‹œ í•´ë‹¹ ì±„íŒ…ë°©ì— ì ‘ì† ì¤‘ì¸ ì‚¬ìš©ì, ì¦‰ ì €ì¥ëœ ì„¸ì…˜ ì „ì²´ì— ë©”ì„¸ì§€ ì „ë‹¬
    4. ì±„íŒ…ë°© í‡´ì¥
        - ì±„íŒ…ë°©ì—ì„œ í‡´ì¥ ì‹œ ì €ì¥ëœ ì„¸ì…˜ ì‚­ì œ(ë©¤ë²„ íƒˆí‡´ê°€ ì•„ë‹ˆë¼ ì—°ê²° ì¢…ë£Œ)


- **ë¬¸ì œ ì •ì˜**:
    - ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ì§€ë§Œ ë‹¨ì¼ ì„œë²„ì—ì„œë§Œ ë™ì‘


- **í•´ê²°**:
    - **ì‚¬ìš© ê¸°ìˆ **
        - **Kafka + STOMP**
            - **Kafka**: ì„œë²„ê°€ ì—¬ëŸ¬ ê°œì¸ ìƒí™©ì—ì„œë„ ë™ì¼í•œ ì±„íŒ…ë°©ì˜ ëª¨ë“  ì‚¬ìš©ìê°€ ë©”ì„¸ì§€ë¥¼ ë°›ì„ ìˆ˜ ìˆë„ë¡ ë„ì…
            - **STOMP**: í‘œì¤€í™”ëœ í”„ë¡œí† ì½œ ì œê³µ, êµ¬ë…ì„ í†µí•´ ì—°ê²°ëœ ì‚¬ìš©ì ê´€ë¦¬ ê°€ëŠ¥
    - **ì›¹ì†Œì¼“ êµ¬ì¡°**
        1. **ì›¹ì†Œì¼“ ì—°ê²°**
            - STOMPì˜ `CONNECT` ì‹œ **JWT ì¸ì¦** (ChannelInterceptor ì‚¬ìš©)
            - ì—”ë“œí¬ì¸íŠ¸: `/ws`
        2. **êµ¬ë…**
            - STOMPì˜ `SUBSCRIBE`ë¡œ íŠ¹ì • ì±„íŒ…ë°© êµ¬ë…
            - prefix: `/sub`
        3. **ë©”ì„¸ì§€ ì „ì†¡**
            - STOMPì˜ `SEND`ë¡œ ì„œë²„ì— ë©”ì„¸ì§€ ì „ì†¡
            - ì„œë²„ì˜ Kafka Producer â†’ Kafka Broker ë°œí–‰
            - Kafka Consumer â†’ Kafka Brokerë¡œë¶€í„° ìˆ˜ì‹  í›„ STOMP Brokerë¡œ ë°œí–‰
            - STOMP Broker â†’ êµ¬ë…ìì—ê²Œ ë¸Œë¡œë“œìºìŠ¤íŠ¸
            - prefix: `/pub`


- **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
    - **í™˜ê²½**
        - ì„œë²„ 2ëŒ€ (`8080`, `8081` í¬íŠ¸)
        - ë™ì¼ ì±„íŒ…ë°©ì„ ì–‘ìª½ ì„œë²„ì—ì„œ êµ¬ë…

    - **ê²°ê³¼**
        - ì„œë¡œ ë‹¤ë¥¸ ì„œë²„ì— ìˆëŠ” ì‚¬ìš©ìë„ ë©”ì„¸ì§€ ìˆ˜ì‹  ê°€ëŠ¥
        - **Kafka**ë¥¼ í†µí•œ ë¶„ì‚° ì²˜ë¦¬ë¡œ **ë‹¤ì¤‘ ì„œë²„ í™˜ê²½ì—ì„œë„ ì‹¤ì‹œê°„ ì±„íŒ… ì •ìƒ ì‘ë™**

---

### ğŸ‘¥ ìœ ì € ëª©ë¡ ì¡°íšŒ ì„±ëŠ¥ ê°œì„  ###

- **ê¸°ëŠ¥**:
    - **ìœ ì € ë‹‰ë„¤ì„** or **ì´ë¦„**ìœ¼ë¡œ ê²€ìƒ‰

- **ë¬¸ì œ ì •ì˜**:
    - íšŒì›ì´ ë§ì´ ì§ˆ ìˆ˜ë¡ ë‹‰ë„¤ì„ì´ë‚˜ ì´ë¦„ ê²€ìƒ‰ ì‹œ ë”œë ˆì´ê°€ ë°œìƒ


- **í•´ê²°**:
    1. **redis**ë¥¼ ì´ìš©í•œ ìºì‹±
    2. **ì¸ë±ì‹±**ì„ ì´ìš©í•œ ë¹ ë¥¸ ê²€ìƒ‰
    3. **redis ìºì‹± + ì¸ë±ì‹±** ë™ì‹œ ì ìš©


- **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
    - **í…ŒìŠ¤íŠ¸ ë„êµ¬**: `JMeter`
    - **ì‹œë‚˜ë¦¬ì˜¤**
        - ê°€ìƒì˜ ì‚¬ìš©ìë¥¼ **10,000ëª…**ìœ¼ë¡œ ì„¤ì •
        - 10,000ëª…ì˜ ì‚¬ìš©ìê°€ **600ì´ˆ ë™ì•ˆ ê· ë“±í•˜ê²Œ ì ‘ì†**
        - ë™ì‹œì— ì ‘ì† ì‹œ ì„œë²„ì˜ ì„±ëŠ¥ ë° ì‘ë‹µ ì‹œê°„ ì¸¡ì •
        - í…ŒìŠ¤íŠ¸ ë²„ì „:
            - `v1` : ê¸°ì¡´ API
            - `v2` : ì´ë¦„/ë‹‰ë„¤ì„ ì¸ë±ì‹± ì ìš©
            - `v3` : Redis ìºì‹± ì ìš©
            - `v4` : Redis ìºì‹± + ì¸ë±ì‹±

#### ğŸ“ˆ ì„±ëŠ¥ ë¹„êµ ìš”ì•½

| ë²„ì „ | # Samples | Average (ms) | Min (ms) | Max (ms) | Std. Dev. | Error % | Throughput | Received KB/sec | Sent KB/sec | Avg. Bytes |
|----|-----------|--------------|----------|----------|-----------|---------|------------|-----------------|-------------|------------|
| v1 | 10,000    | 3            | 2        | 38       | 1.02      | 0.00%   | 16.7/sec   | 9.60            | 6.93        | 589.9      |
| v2 | 10,000    | 2            | 1        | 26       | 0.94      | 0.00%   | 16.7/sec   | 9.60            | 6.98        | 589.9      |
| v3 | 10,000    | 2            | 1        | 27       | 0.86      | 0.00%   | 16.7/sec   | 9.60            | 6.98        | 589.9      |
| v4 | 10,000    | 1            | 1        | 59       | 1.00      | 0.00%   | 16.7/sec   | 9.63            | 7.00        | 591.9      |

> `v4`ì˜ ìµœëŒ€ ì‘ë‹µ ì‹œê°„ì´ ë‹¤ë¥¸ ë²„ì „ë³´ë‹¤ ë†’ê²Œ ë‚˜íƒ€ë‚¬ìœ¼ë‚˜, ì´ëŠ” ìºì‹œ ì´ˆê¸° ì ìš© ì‹œë‚˜ íŠ¹ì • ìŠ¤ë ˆë“œì—ì„œ ìºì‹œ ê°±ì‹  ë“±ì˜ ì˜í–¥ìœ¼ë¡œ ë°œìƒí•œ ì¼ì‹œì  ì§€ì—°ìœ¼ë¡œ íŒë‹¨
> <br> ëŒ€ë¶€ë¶„ ìš”ì²­ì€ **1ms ë‚´ ì²˜ë¦¬**ë˜ì–´ ì„±ëŠ¥ì´ ê°€ì¥ ìš°ìˆ˜í•˜ë©°, ë”°ë¼ì„œ **v4 ë²„ì „ì„ ì±„íƒ**

- **ì„±ëŠ¥ ê°œì„  ìš”ì•½**
    - í‰ê·  ì‘ë‹µ ì‹œê°„: **3ms â†’ 1ms ìˆ˜ì¤€ìœ¼ë¡œ ë‹¨ì¶• (ì•½ 3ë°° ê°œì„ )**

---

### ğŸ§¾ ì£¼ë¬¸ ë‚´ì—­ ë‹¨ì¼ ì¡°íšŒ ì„±ëŠ¥ ê°œì„  ###

- **ê¸°ëŠ¥**:
    - ê¸°ì¡´ ì£¼ë¬¸ ë‚´ì—­ ë‹¨ì¼ ì¡°íšŒ ê¸°ëŠ¥ì˜ ê²½ìš° `QueryDSL`ì„ ì´ìš©í•œ ë°©ì‹ìœ¼ë¡œ ê²€ìƒ‰ ê¸°ëŠ¥ì´ ì‘ë™


- **ë¬¸ì œ ì •ì˜**:
    - ì£¼ë¬¸ ë‚´ì—­ ë‹¨ì¼ ì¡°íšŒ ì‹œ ë§¤ë²ˆ **DB ì¡°íšŒê°€ ë°œìƒ**í•˜ê¸° ë•Œë¬¸ì— ì‘ë‹µì´ ì§€ì—°ë  ìš°ë ¤


- **í•´ê²°**:
    - ì²« ì¡°íšŒ ì‹œ DBì—ì„œ ë°ì´í„° ì¡°íšŒ í›„ **ìºì‹œì— ì €ì¥**
    - ì´í›„ ë™ì¼ ë‚´ì—­ ì¡°íšŒ ì‹œ ìºì‹œì—ì„œ ë¹ ë¥´ê²Œ ì¡°íšŒ


- **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
    - **í…ŒìŠ¤íŠ¸ ë„êµ¬**: `JMeter`
    - **ì‹œë‚˜ë¦¬ì˜¤**
        - ìœ ì €ê°€ ì£¼ë¬¸ ë‚´ì—­ ë‹¨ì¼ ì¡°íšŒë¥¼ 15ë²ˆ ë°˜ë³µ(ê° ìš”ì²­ ê°„ê²© 500ms)

#### ğŸ“‰ ìºì‹œ ì ìš© ì „

<img src="img/OrderSearch_1.png" width="600"/>

#### ğŸš€ ë„ì… í›„ (Elasticsearch ê¸°ë°˜)

<img src="img/OrderSearch_2.png" width="600"/>

#### ğŸ“ˆ ì„±ëŠ¥ ê°œì„  ìš”ì•½ ë¹„êµ

| êµ¬ë¶„      | Average | Median | 90% Line | 95% Line | 99% Line | Min | Max |
|---------|---------|--------|----------|----------|----------|-----|-----|
| ìºì‹± ì ìš© ì „ | 13      | 13     | 16       | 16       | 30       | 11  | 30  |
| ìºì‹± ì ìš© í›„ | 9       | 8      | 10       | 10       | 37       | 7   | 37  |

- **ì„±ëŠ¥ ê°œì„  ìš”ì•½**
    - í‰ê·  ì‘ë‹µ ì‹œê°„: **ì•½ 13ms â†’ 9ms ìˆ˜ì¤€ìœ¼ë¡œ ë‹¨ì¶• (ì•½ 31% ê°ì†Œ)**
    - **Max**ì™€ **99% Line** ê°’ ì¦ê°€ â†’ ì²« ë²ˆì§¸ ì¡°íšŒ ì‹œ DB ì¡°íšŒ + ìºì‹œ ì €ì¥ìœ¼ë¡œ ì¸í•œ ì¼ì‹œì  ì§€ì—°

---

### ğŸ§¾ ì£¼ë¬¸ ë‚´ì—­ í˜ì´ì§• ì¡°íšŒ ì„±ëŠ¥ ê°œì„  ###

- **ê¸°ëŠ¥**:
    - ê¸°ì¡´ ì£¼ë¬¸ ë‚´ì—­ í˜ì´ì§• ì¡°íšŒ ê¸°ëŠ¥ì˜ ê²½ìš° `QueryDSL`ì„ ì´ìš©í•œ ë°©ì‹ìœ¼ë¡œ ê²€ìƒ‰ ê¸°ëŠ¥ì´ ì‘ë™


- **ë¬¸ì œ ì •ì˜**:
    - ì£¼ë¬¸ ë‚´ì—­ì´ ë§ì„ ê²½ìš° **ì¡°íšŒ ì†ë„ ì§€ì—° ë° DB ë¶€í•˜** ë°œìƒ ìš°ë ¤

    - **í•´ê²°**:
        - **ì»¤ë²„ë§ ì¸ë±ìŠ¤**ë¥¼ ì ìš©
            - `order ID` ëª©ë¡ì„ ì¡°íšŒ í›„ í•´ë‹¹ IDë¡œ ì‹¤ì œ ë°ì´í„° ì¡°íšŒ

        - **ì ìš© ì „ ì½”ë“œ**
        ```java
          @Override
          public Page<OrderResponseDto> findOrdersByUserId(Long userId, Pageable pageable, String menuName, String storeName, LocalDate startDate, LocalDate endDate, OrderStatus status) {
                  List<OrderResponseDto> content = queryFactory.select(new QOrderResponseDto(order))
                           .from(order)
                           .join(order.store).fetchJoin() // ì£¼ë¬¸ê³¼ ê°€ê²Œ ì •ë³´ë¥¼ í•œ ë²ˆì— ì¡°íšŒ
                           .where(searchOrder(userId, menuName, storeName, startDate, endDate, status))
                           .orderBy(order.createdAt.desc())
                           .offset(pageable.getOffset())
                           .limit(pageable.getPageSize())
                           .fetch();
  
                  JPAQuery<Long> countQuery = queryFactory.select(order.count())
                           .from(order)
                           .where(searchOrder(userId, menuName, storeName, startDate, endDate, status));
  
                  return PageableExecutionUtils.getPage(content, pageable, countQuery::fetchOne);
          }
        ```
        - **ì ìš© í›„ ì½”ë“œ**

        ```java
        @Override
        public Page<OrderResponseDto> findOrdersByUserId(Long userId, Pageable pageable, String menuName, String storeName, LocalDate startDate, LocalDate endDate, OrderStatus status) {
        
                // order id ë¨¼ì € ì¡°íšŒ
                List<Long> idList = queryFactory
                        .select(order.id)
                        .from(order)
                        .where(searchOrder(userId, menuName, storeName, startDate, endDate, status))
                        .orderBy(order.createdAt.desc())
                        .offset(pageable.getOffset())
                        .limit(pageable.getPageSize())
                        .fetch();
        
                // idListê°€ ë¹„ì–´ìˆëŠ” ê²½ìš° ë¹ˆ í˜ì´ì§€ ë°˜í™˜
                if (idList.isEmpty()) {
                    return new PageImpl<>(Collections.emptyList(), pageable, 0);
                }
        
                // idë¡œ ì‹¤ì œ ë°ì´í„° ì¡°íšŒ
                List<OrderResponseDto> content = queryFactory.select(new QOrderResponseDto(order))
                        .from(order)
                        .join(order.store).fetchJoin() // ì£¼ë¬¸ê³¼ ê°€ê²Œ ì •ë³´ë¥¼ í•œ ë²ˆì— ì¡°íšŒ
                        .where(order.id.in(idList))
                        .orderBy(order.createdAt.desc())
                        .fetch();
        
                JPAQuery<Long> countQuery = queryFactory.select(order.count())
                        .from(order)
                        .where(searchOrder(userId, menuName, storeName, startDate, endDate, status));
        
                return PageableExecutionUtils.getPage(content, pageable, countQuery::fetchOne);
        
        }
        ```

- **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
    - **í…ŒìŠ¤íŠ¸ ë„êµ¬**: `JMeter`
    - **ì‹œë‚˜ë¦¬ì˜¤**
        - ìœ ì € 1ëª…ì´ 500ê°œì˜ ì£¼ë¬¸ ë‚´ì—­ ì¡°íšŒ, 1ì´ˆ ê°„ê²© 10íšŒ ë°˜ë³µ

#### ğŸ“ˆ ì„±ëŠ¥ ë¹„êµ ìš”ì•½

<details>
  <summary>ìƒì„¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼</summary>
  <p><strong>ì¸ë±ìŠ¤ ì ìš© ì „</strong></p>
  <img src="img/OrderSearch_3.png" width="600"/>
<img src="img/OrderSearch_4.png" width="600"/>
<img src="img/OrderSearch_5.png" width="600"/>
<img src="img/OrderSearch_6.png" width="600"/>

<p><strong>ì¸ë±ìŠ¤ ì ìš© í›„</strong></p>
<img src="img/OrderSearch_7.png" width="600"/>
<img src="img/OrderSearch_8.png" width="600"/>
<img src="img/OrderSearch_9.png" width="600"/>
<img src="img/OrderSearch_10.png" width="600"/>
</details>

| êµ¬ë¶„       | Average | Median | 90% Line | 95% Line | 99% Line | Min  | Max   |
|----------|---------|--------|----------|----------|----------|------|-------|
| ì¸ë±ìŠ¤ ì ìš© ì „ | 10.75   | 10.75  | 12.75    | 13       | 14.25    | 9.75 | 14.25 |
| ì¸ë±ìŠ¤ ì ìš© í›„ | 8.25    | 8.25   | 9.25     | 9.25     | 10.5     | 7.75 | 10.5  |

- **ì„±ëŠ¥ ê°œì„  ìš”ì•½**
    - í‰ê·  ì‘ë‹µ ì‹œê°„: **ì•½ 10.75ms â†’ 8.25ms ìˆ˜ì¤€ìœ¼ë¡œ ë‹¨ì¶• (ì•½ 23% ê°ì†Œ)**
    - ìš”ì²­ 9.25ms ì´ë‚´ ì²˜ë¦¬

---

### ğŸ›’ ê³µìœ  ì¥ë°”êµ¬ë‹ˆ ë‹¨ì¼ ì¡°íšŒ ì„±ëŠ¥ ê°œì„  ###

- **ê¸°ëŠ¥**:
    - ê³µìœ  ì¥ë°”êµ¬ë‹ˆ(ì±„íŒ…ë°© ë‹¨ìœ„) ì¡°íšŒ ì‹œ **ë¶ˆí•„ìš”í•œ ì¶”ê°€ ì¿¼ë¦¬(N+1)**ì™€ ì„œë²„ ë©”ëª¨ë¦¬ ì§‘ê³„ë¥¼ ì¤„ì—¬ ì‘ë‹µ ì‹œê°„ì„ ì•ˆì •í™”


- **ë¬¸ì œ ì •ì˜**:
    - `findBySharedCart_ChatRoom_Id(roomId)` í˜¸ì¶œ ì‹œ `Menu/User/SharedCart`ë¥¼ LAZY ë¡œë”©í•˜ë©° **N+1 ë°œìƒ ê°€ëŠ¥**
    - ì°¸ì—¬ì ìˆ˜ë¥¼ Java ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ `distinct()` ê³„ì‚° â†’ ëª¨ë“  í•­ëª©ì„ ë©”ëª¨ë¦¬ë¡œ ëŒì–´ì™€ **ì§‘ê³„ ë¹„ìš© ì¦ê°€**


- **í•´ê²°**:
    - **`Fetch Join`ìœ¼ë¡œ í•œ ë²ˆì— ë¡œë”©** (N+1 ì œê±°)
    - **DBì—ì„œ ì°¸ì—¬ì ìˆ˜ ì§‘ê³„** (COUNT DISTINCT)
    - **ì„œë¹„ìŠ¤ ë¡œì§ êµì²´** (ë©”ëª¨ë¦¬ ì§‘ê³„ â†’ DB ì§‘ê³„)
    - **ì¸ë±ìŠ¤ ì¶”ê°€** (ì¡°íšŒ/ê¶Œí•œê²€ì‚¬ ê°€ì†)


- **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
    - **í…ŒìŠ¤íŠ¸ ë„êµ¬**: `JMeter`
    - **ì‹œë‚˜ë¦¬ì˜¤**
        - ë™ì¼ ì±„íŒ…ë°©ì— `N`ê°œ í•­ëª©, ë‹¤ìˆ˜ ì‚¬ìš©ì ì°¸ì—¬
        - ìœ ì € 1ëª…ì´ GET /chats/{roomId}/.../shared-carts/items 10~15íšŒ ë°˜ë³µ (ìš”ì²­ ê°„ê²© 500ms)

#### ğŸ“ˆ ì„±ëŠ¥ ë¹„êµ ìš”ì•½

| êµ¬ë¶„       | Average | Median | 90% Line | 95% Line | 99% Line | Min  | Max   |
|----------|---------|--------|----------|----------|----------|------|-------|
| ì¸ë±ìŠ¤ ì ìš© ì „ | 11.50   | 11.50  | 13.50    | 14.25    | 16.00    | 9.75 | 16.00 |
| ì¸ë±ìŠ¤ ì ìš© í›„ | 8.75    | 8.50   | 9.75     | 10.25    | 12.25    | 7.50 | 12.25 |

- **ì„±ëŠ¥ ê°œì„  ìš”ì•½**
    - `N+1` ì œê±° + `DB` ì§‘ê³„ + ì¸ë±ìŠ¤ë¡œ í‰ê·  **24% ë‹¨ì¶•**
    - **95% êµ¬ê°„ 28% ê°œì„ **

---

## ğŸ”§ ì„¤ì¹˜ ë° ì‹¤í–‰ ë°©ë²•

<details>
<summary>í´ë¦­í•˜ì—¬ ì„¤ì¹˜ ë° ì‹¤í–‰ ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”</summary>

1. ë ˆí¬ì§€í† ë¦¬ í´ë¡ 

- í„°ë¯¸ë„ ë˜ëŠ” ëª…ë ¹ í”„ë¡¬í”„íŠ¸ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ í”„ë¡œì íŠ¸ ë ˆí¬ì§€í† ë¦¬ë¥¼ í´ë¡ í•©ë‹ˆë‹¤.

```bash
git clone https://github.com/hojunyun-dev/Eat_Together.git
```

2. Docker ì‹¤í–‰

```bash
docker-compose up -d --build
```

- ì˜¤ë¥˜ ë°œìƒ ì‹œ:

```bash
docker-compose down -v
```

- Dockerì— í”„ë¡œì íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ì˜¬ë¼ì™€ ìˆëŠ”ì§€ í™•ì¸

</details> 

## âš¡ ì‚¬ì „ ì¤€ë¹„

<details>
<summary>í´ë¦­í•˜ì—¬ ì‚¬ì „ ì¤€ë¹„ë¥¼ í™•ì¸í•˜ì„¸ìš”</summary>

- JDK 17 ë²„ì „ì„ ì¤€ë¹„í•´ì£¼ì„¸ìš”.
- Dockerë¥¼ ì„¤ì¹˜í•´ì£¼ì„¸ìš” ( ìµœì‹ ë²„ì „ìœ¼ë¡œ ì¤€ë¹„í•´ì£¼ì„¸ìš” )
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
    - backend ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•˜ì—¬ .env.example íŒŒì¼ì„ ì°¸ê³ í•´ .env íŒŒì¼ì„ ìƒì„±í•˜ê³  í•„ìš”í•œ í™˜ê²½ ë³€ìˆ˜ë“¤ì„ ì„¤ì •í•©ë‹ˆë‹¤.
    - cd backend

```
.env íŒŒì¼ ë‚´ìš© ì˜ˆì‹œ:
# Google
GOOGLE_OAUTH_CLIENT_ID = { Google_CLIENT_ID }
GOOGLE_OAUTH_CLIENT_SECRET = { Google_SECRET_KEY } 

# Kakao
KAKAO_OAUTH_CLIENT_ID = { Kakao_CLIENT_ID }
KAKAO_OAUTH_CLIENT_SECRET = { Kakao_SECRET_KEY } 

# naver
NAVER_OAUTH_CLIENT_ID = { Naver_CLIENT_ID }
NAVER_OAUTH_CLIENT_SECRET = { Naver_SECRET_KEY } 

# Mysql
MYSQL_PORT = { MYSQL_PORT }
MYSQL_USERNAME = { DB_USERNAME }
MYSQL_PASSWORD = { DB_PASSWORD }
MYSQL_DBNAME = { DBNAME }

# Redis
REDIS_PORT = { REDIS_PORT }

# ì´ ë¶€ë¶„ì„ ê°ì ì„¤ì •ì— ë§ê²Œ ì„¤ì •í•´ì£¼ì„¸ìš”
```

</details> 

### ğŸ¤ ê¸°ì—¬ ë°©ë²•

- ì´ í”„ë¡œì íŠ¸ì— ëŒ€í•œ ì—¬ëŸ¬ë¶„ì˜ ê¸°ì—¬ë¥¼ í™˜ì˜í•©ë‹ˆë‹¤! í”„ë¡œì íŠ¸ë¥¼ í•¨ê»˜ ë°œì „ì‹œí‚¤ê¸° ìœ„í•œ ê°€ì´ë“œë¼ì¸ì„ ë”°ë¦…ë‹ˆë‹¤.

### ğŸŒ³ ê¸°ì—¬ ì ˆì°¨

- ì´ìŠˆ ìƒì„±: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì œì•ˆ, ë²„ê·¸ ë¦¬í¬íŠ¸, ê°œì„  ì‚¬í•­ ë“±ì— ëŒ€í•´ ë¨¼ì € ì´ìŠˆë¥¼ ìƒì„±í•˜ì—¬ ë…¼ì˜í•©ë‹ˆë‹¤.
- í¬í¬ (Fork): ë³¸ ë ˆí¬ì§€í† ë¦¬ë¥¼ ê°œì¸ GitHub ê³„ì •ìœ¼ë¡œ í¬í¬í•©ë‹ˆë‹¤.
- í´ë¡  (Clone): í¬í¬í•œ ë ˆí¬ì§€í† ë¦¬ë¥¼ ë¡œì»¬ í™˜ê²½ìœ¼ë¡œ í´ë¡ í•©ë‹ˆë‹¤.   
  `git clone https://github.com/hojunyun-dev/Eat_Together.git`

---

> - ë¸Œëœì¹˜ ìƒì„±: ì‘ì—…í•  ë‚´ìš©ì— ë§ëŠ” ìƒˆ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
>- ìƒˆë¡œìš´ ê¸°ëŠ¥: git checkout -b feature/OOO-ê¸°ëŠ¥ëª…
>- ì½”ë“œ ì‘ì„± ë° í…ŒìŠ¤íŠ¸: í•´ë‹¹ ë¸Œëœì¹˜ì—ì„œ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ì¶©ë¶„í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.
>- ì»¤ë°‹ (Commit): ì»¤ë°‹ ì»¨ë²¤ì…˜ì— ë”°ë¼ ëª…í™•í•œ ì»¤ë°‹ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. `git commit -m "feat: OOO ê¸°ëŠ¥ ì¶”ê°€"`
> - í‘¸ì‹œ (Push): ë³€ê²½ì‚¬í•­ì„ ë³¸ì¸ì˜ ì›ê²© ì €ì¥ì†Œì— í‘¸ì‹œí•©ë‹ˆë‹¤. `git push origin feature/OOO-ê¸°ëŠ¥ëª…`
> - í’€ ë¦¬í€˜ìŠ¤íŠ¸ (Pull Request) ìƒì„±: ë³¸ ë ˆí¬ì§€í† ë¦¬ì˜ main ë¸Œëœì¹˜ë¡œ í’€ ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë³€ê²½ ì‚¬í•­ì— ëŒ€í•œ ìƒì„¸í•œ ì„¤ëª…ì„ í¬í•¨í•´ì£¼ì„¸ìš”.

---

## ğŸ¨ ì½”ë“œ ìŠ¤íƒ€ì¼ ë° ì»¨ë²¤ì…˜

- ì»¤ë°‹ ë©”ì‹œì§€: Conventional Commits ê·œê²©ì„ ë”°ë¦…ë‹ˆë‹¤. (ì˜ˆ: feat: add user authentication, fix: resolve login bug)
- ë¸Œëœì¹˜ ì „ëµ: main ë¸Œëœì¹˜ëŠ” í•­ìƒ ì•ˆì •ì ì¸ ë²„ì „ì„ ìœ ì§€í•˜ë©°, ê°œë°œì€ í”¼ì²˜ ë¸Œëœì¹˜ì—ì„œ ì§„í–‰ë©ë‹ˆë‹¤.

## ğŸ¤ ë°¥ì‚¬ì¡° Project Members

<div align="center">
  <table>
    <tbody>
      <tr>
        <td align="center" style="padding: 20px;">
          <img src="https://avatars.githubusercontent.com/u/208747870?v=4" width="120px" style="border-radius: 50%;" alt=""/>
          <div style="margin-top: 10px; font-size: 14px; line-height: 1.2;">
            <b>íŒ€ì¥</b><br />
            <a href="https://github.com/hojunyun-dev" style="font-size: 16px;">ìœ¤í˜¸ì¤€</a>
            <div style="margin-top: 5px; font-size: 14px;">
              ë¼ì´ë”<br />ì•Œë¦¼<br />CI/CD<br />
            </div>
          </div>
        </td>
        <td align="center" style="padding: 20px;">
          <img src="https://avatars.githubusercontent.com/u/180087698?v=4" width="120px" style="border-radius: 50%;" alt=""/>
          <div style="margin-top: 10px; font-size: 14px; line-height: 1.2;">
            <b>ë¶€íŒ€ì¥</b><br />
            <a href="https://github.com/Ddiy0ng" style="font-size: 16px;">ë°•ì†Œí¬</a>
            <div style="margin-top: 5px; font-size: 14px;">
              ì±„íŒ…<br />
            </div>
          </div>
        </td>
        <td align="center" style="padding: 20px;">
          <img src="https://avatars.githubusercontent.com/u/206229978?v=4" width="120px" style="border-radius: 50%;" alt=""/>
          <div style="margin-top: 10px; font-size: 14px; line-height: 1.2;">
            <b>íŒ€ì›</b><br />
            <a href="https://github.com/syumz" style="font-size: 16px;">ì„ì„œì—°</a>
            <div style="margin-top: 5px; font-size: 14px;">
              ì£¼ë¬¸<br />ê²°ì œ<br />
            </div>
          </div>
        </td>
        <td align="center" style="padding: 20px;">
          <img src="https://avatars.githubusercontent.com/u/116245550?v=4" width="120px" style="border-radius: 50%;" alt=""/>
          <div style="margin-top: 10px; font-size: 14px; line-height: 1.2;">
            <b>íŒ€ì›</b><br />
            <a href="https://github.com/Gyum1" style="font-size: 16px;">ì´íƒœê²¸</a>
            <div style="margin-top: 5px; font-size: 14px;">
              ì¥ë°”êµ¬ë‹ˆ<br />
            </div>
          </div>
        </td>
        <td align="center" style="padding: 20px;">
          <img src="https://avatars.githubusercontent.com/u/204646196?v=44" width="120px" style="border-radius: 50%;" alt=""/>
          <div style="margin-top: 10px; font-size: 14px; line-height: 1.2;">
            <b>íŒ€ì›</b><br />
            <a href="https://github.com/4ouChan" style="font-size: 16px;">ê¹€í˜„ì°¬</a>
            <div style="margin-top: 5px; font-size: 14px;">
              ë§¤ì¥<br />ë©”ë‰´<br />
            </div>
          </div>
        </td>
        <td align="center" style="padding: 20px;">
          <img src="https://avatars.githubusercontent.com/u/94787456?v=4" width="120px" style="border-radius: 50%;" alt=""/>
          <div style="margin-top: 10px; font-size: 14px; line-height: 1.2;">
            <b>íŒ€ì›</b><br />
            <a href="https://github.com/KimDohwan24" style="font-size: 16px;">ê¹€ë„í™˜</a>
            <div style="margin-top: 5px; font-size: 14px;">
              ìœ ì €<br />ëª¨ë‹ˆí„°ë§<br />
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

## [ğŸ“š ë°¥ì‚¬ì¡° Team Notion ë³´ëŸ¬ê°€ê¸°](https://www.notion.so/teamsparta/2322dc3ef5148046a7cdc53504fdd459)

